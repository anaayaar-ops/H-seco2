name: Continuous Bot Runner

on:
  schedule:
    # ÙŠØ¹Ù…Ù„ ÙƒÙ„ 4 Ø³Ø§Ø¹Ø§Øª Ø¨ØªÙˆÙ‚ÙŠØª Ù…ÙƒØ© (ØªØ¬Ù†Ø¨ 9 AM - 12 PM Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„)
    - cron: '0 22,2,6,10,14,18 * * *'
  workflow_dispatch:

concurrency:
  group: wolf-bot-running
  cancel-in-progress: true 

jobs:
  run-bot:
    runs-on: ubuntu-latest
    timeout-minutes: 240 
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Dependencies
        run: npm install

      - name: Execution Logic
        env:
          U_MAIL: ${{ secrets.U_MAIL }}
          U_PASS: ${{ secrets.U_PASS }}
          ENTRY_P: ${{ secrets.ENTRY_P }}
          EXIT_P: ${{ secrets.EXIT_P }}
          MATCH_V: ${{ secrets.MATCH_V }}
          EXEC_V: ${{ secrets.EXEC_V }}
        run: |
          # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨ØªÙˆÙ‚ÙŠØª Ù…ÙƒØ©
          HOUR=$(date -u -d "+3 hours" +%H)
          
          echo "â° Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø¢Ù† Ø¨ØªÙˆÙ‚ÙŠØª Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©: $HOUR"

          # Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø§Ø­Ø©: Ø§Ù„ØªÙˆÙ‚Ù Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³Ø§Ø¹Ø© Ø¨ÙŠÙ† 9 ØµØ¨Ø§Ø­Ø§Ù‹ Ùˆ 12 Ø¸Ù‡Ø±Ø§Ù‹
          if [ "$HOUR" -ge 9 ] && [ "$HOUR" -lt 12 ]; then
            echo "ğŸ’¤ ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ø±Ø³Ù…ÙŠ. Ø§Ù„Ø³ÙŠØ±ÙØ± Ø³ÙŠØ¨Ù‚Ù‰ Ø®Ø§Ù…Ù„Ø§Ù‹."
            exit 0
          fi
          
          echo "ğŸš€ Ø¨Ø¯Ø¡ Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ (4 Ø³Ø§Ø¹Ø§Øª)..."
          
          # ØªØ´ØºÙŠÙ„ Ù…Ù„Ù app.js
          node app.js
