name: Continuous Bot Runner

on:
  schedule:
    # ุงูููุงุนูุฏ ุจุชูููุช ููุฉ (UTC+3):
    # 01:00 AM, 05:00 AM, 09:00 AM (ุณูุชู ุฑูุถู ุจุฑูุฌูุงู), 01:00 PM, 05:00 PM, 09:00 PM
    - cron: '0 22,2,6,10,14,18 * * *'
  workflow_dispatch:

concurrency:
  group: wolf-bot-running
  # ูุบูู ุงููุณุฎุฉ ุงููุฏููุฉ ููุฑ ุจุฏุก ูุณุฎุฉ ุฌุฏูุฏุฉ ูููุน ุชุฏุงุฎู ุงูุฌูุณุงุช
  cancel-in-progress: true 

jobs:
  run-bot:
    runs-on: ubuntu-latest
    # ุงููููุฉ 4 ุณุงุนุงุช (240 ุฏูููุฉ) ูุชุชูุงุณุจ ูุน ุฏูุฑุฉ ุฅุนุงุฏุฉ ุงูุชุดุบูู
    timeout-minutes: 240 
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Dependencies
        run: npm install

      - name: Execution Logic
        env:
          U_MAIL: ${{ secrets.U_MAIL }}
          U_PASS: ${{ secrets.U_PASS }}
          ENTRY_P: ${{ secrets.ENTRY_P }}
          EXIT_P: ${{ secrets.EXIT_P }}
          MATCH_V: ${{ secrets.MATCH_V }}
          EXEC_V: ${{ secrets.EXEC_V }}
        run: |
          # ุงูุญุตูู ุนูู ุงูุณุงุนุฉ ุงูุญุงููุฉ ุจุชูููุช ููุฉ
          HOUR=$(date -u -d "+3 hours" +%H)
          
          echo "โฐ ุงูุณุงุนุฉ ุงูุขู ุจุชูููุช ููุฉ ุงูููุฑูุฉ: $HOUR"

          # ูุธุงู ุงูุฑุงุญุฉ: ูู 9 ุตุจุงุญุงู ุญุชู 12 ุธูุฑุงู (ูู ูุชู ุชุดุบูู ุงูููุฏ ูู ูุฐู ุงููุชุฑุฉ)
          if [ "$HOUR" -ge 9 ] && [ "$HOUR" -lt 12 ]; then
            echo "๐ค ุชูููุช ุงูุฑุงุญุฉ ุงูุฑุณูู (9 AM - 12 PM). ุณูุบูู ุงูุณูุฑูุฑ ุงูุขู."
            exit 0
          fi
          
          echo "๐ ุจุฏุก ุฏูุฑุฉ ุงูุชุดุบูู (4 ุณุงุนุงุช)..."
          
          # ุชุดุบูู ููุฏ ุงูู JS ูุจุงุดุฑุฉ (ุจุฏูู & ูุจุฏูู sleep ูู ุงูู Bash)
          # ููุฏ ุงูู JS ูู ูู ุณูุชููู ุจุงูุฑุงุญุฉ (6 ุฏูุงุฆู ูู ุณุงุนุฉ) ุฏุงุฎููุงู
          node index.js
